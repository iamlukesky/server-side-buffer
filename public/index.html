<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>tourMap</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet-providers/1.1.15/leaflet-providers.min.js"></script>
    <script src="https://d3js.org/d3.v4.js"></script>

    <style>
      body {
        padding: 0;
        margin: 0;
      }
      html, body, #map {
        height: 100vh;
        width: 100vw;
      }
    </style>
  </head>
  <body>

    <div id="map"></div>

    <script>

      var map = L.map('map');
      L.tileLayer.provider('OpenStreetMap.BlackAndWhite').addTo(map);
      map.setView([59.311162, 18.074806], 13);

      map.on('click', function(e){

        L.marker(e.latlng).addTo(map);

        var point = {
          "type": "Feature",
          "properties": {},
          "geometry": {
            "type": "Point",
            "coordinates": [e.latlng.lng, e.latlng.lat]
          }
        };

        d3.json('/bufferpoint')
        .header("Content-Type", "application/json")
        .post(JSON.stringify(point), drawBufferedPoint);


      });

      function drawBufferedPoint(err, buffpoint){
        console.log("got it");
        console.log(buffpoint);
        var layer = L.geoJSON(buffpoint, {
          style: {
            color: "blue"
          }
        }).addTo(map);
      }

    </script>

  </body>
</html>
